import t from"glob";var e=require("fs"),r=function(r){return Array.isArray(r)?function(t,r){return t.reduce(function(t,r){var n="";try{n=e.readFileSync(r,"utf8").toLowerCase()}catch(t){console.warn(t.message)}return""+t+n+" "},"")}(r=function(n){for(var i={},s=0,o=r;s<o.length;s+=1){var a=o[s];try{e.statSync(a),i[a]=!0}catch(e){t.sync(a).forEach(function(t){i[t]=!0})}}return Object.keys(i)}()):r},n=function(t){if((t=t.replace(/\[(.+?)\]/g,"").toLowerCase()).includes("[")||t.includes("]"))return[];for(var e=!1,r="",n=[],i=0,s=t;i<s.length;i+=1){var o=s[i];e&&!/[ #.]/.test(o)||(/[:*]/.test(o)?(r&&n.push(r),r="",e=!0):/[a-z]/.test(o)?r+=o:(r&&n.push(r),r="",e=!1))}return r&&n.push(r),n},i=function(t,e){this.contentWords=t,this.rejectedSelectors=[],this.wildcardWhitelist=[],this.parseWhitelist(e)};i.prototype.parseWhitelist=function(t){var e=this;t.forEach(function(t){var r;"*"===(r=t=t.toLowerCase())[0]&&"*"===r[r.length-1]?e.wildcardWhitelist.push(t.substr(1,t.length-2)):n(t).forEach(function(t){e.contentWords[t]=!0})})},i.prototype.parseRule=function(t,e){e.selectors=this.filterSelectors(t)},i.prototype.filterSelectors=function(t){var e=this.contentWords,r=this.rejectedSelectors,i=this.wildcardWhitelist,s=[];return t.forEach(function(t){if(function(t,e){for(var r=0,n=i;r<n.length;r+=1)if(t.includes(n[r]))return!0;return!1}(t))s.push(t);else{var o=n(t);o.filter(function(t){return e[t]}).length===o.length?s.push(t):r.push(t)}}),s};var s=/\/\*[^*]*\*+([^\/*][^*]*\*+)*\//g;function o(t){return t?t.replace(/^\s+|\s+$/g,""):""}function a(t){void 0===t&&(t={}),this.options=t}a.prototype.compile=function(t){return this.stylesheet(t)},a.prototype.stylesheet=function(t){return this.mapVisit(t.stylesheet.rules)},a.prototype.mapVisit=function(t){for(var e="",r=0,n=t.length;r<n;r++)e+=this[t[r].type](t[r]);return e},a.prototype.comment=function(){return""},a.prototype.import=function(t){return"@import "+t.import+";"},a.prototype.media=function(t){return"@media "+t.media+"{"+this.mapVisit(t.rules)+"}"},a.prototype.document=function(t){return"@"+(t.vendor||"")+"document "+t.document+"  {"+this.mapVisit(t.rules)+"}"},a.prototype.charset=function(t){return"@charset "+t.charset+";"},a.prototype.namespace=function(t){return"@namespace "+t.namespace+";"},a.prototype.supports=function(t){return"@supports "+t.supports+" {"+this.mapVisit(t.rules)+"}"},a.prototype.keyframes=function(t){return"@"+(t.vendor||"")+"keyframes "+t.name+" {"+this.mapVisit(t.keyframes)+"}"},a.prototype.keyframe=function(t){var e=t.declarations;return t.values.join(", ")+" {"+this.mapVisit(e)+"}"},a.prototype.page=function(t){var e=t.selectors,r=t.declarations;return"@page "+(e.length?e.join(", ")+" ":"")+"{"+this.mapVisit(r)+"}"},a.prototype["font-face"]=function(t){return"@font-face {"+this.mapVisit(t.declarations)+"}"},a.prototype.host=function(t){return"@host {"+this.mapVisit(t.rules)+"}"},a.prototype["custom-media"]=function(t){return"@custom-media "+t.name+" "+t.media+";"},a.prototype.rule=function(t){var e=t.declarations;return e.length?t.selectors.join(",")+"{"+this.mapVisit(e)+"}":""},a.prototype.declaration=function(t){return t.property+": "+t.value+";"},require("fs");var u=function(t,e){for(var r=0,n=t;r<n.length;r+=1){var i=n[r];"rule"===i.type?e.parseRule(i.selectors,i):"media"===i.type&&u(i.rules,e)}},c=function(t){for(var e=[],r=0,n=t;r<n.length;r+=1){var i=n[r],s=i.type;"rule"===s&&0===i.selectors.length?e.push(i):"media"===s&&(c(i.rules),0===i.rules.length&&e.push(i))}e.forEach(function(e){var r=t.indexOf(e);t.splice(r,1)})};export default function(t,e,n){void 0===n&&(n={});var f,p=n.whitelist||[],l=r(e),m=r(t).toLowerCase().split(/[^a-z]/g).reduce(function(t,e){return t[e]=!0,t},{html:!0,body:!0}),h=new i(m,p),v=function(t,e){e=e||{};var r=1,n=1;function i(t){var e=t.match(/\n/g);e&&(r+=e.length);var i=t.lastIndexOf("\n");n=~i?t.length-i:n+t.length}function a(){var t={line:r,column:n};return function(e){return e.position=new u(t),v(),e}}function u(t){this.start=t,this.end={line:r,column:n},this.source=e.source}u.prototype.content=t;var c=[];function f(i){var s=new Error(e.source+":"+r+":"+n+": "+i);if(s.reason=i,s.filename=e.source,s.line=r,s.column=n,s.source=t,!e.silent)throw s;c.push(s)}function p(){return h(/^{\s*/)}function l(){return h(/^}/)}function m(){var e,r,n,i=[];for(v(),y(i);t.length&&"}"!=t.charAt(0)&&(e=W()||(r=void 0,r=a(),(n=g())?(y(),r({type:"rule",selectors:n,declarations:k()})):f("selector missing")));)!1!==e&&(i.push(e),y(i));return i}function h(e){var r=e.exec(t);if(r){var n=r[0];return i(n),t=t.slice(n.length),r}}function v(){h(/^\s*/)}function y(t){var e;for(t=t||[];e=d();)!1!==e&&t.push(e);return t}function d(){var e=a();if("/"==t.charAt(0)&&"*"==t.charAt(1)){for(var r=2;""!=t.charAt(r)&&("*"!=t.charAt(r)||"/"!=t.charAt(r+1));)++r;if(""===t.charAt((r+=2)-1))return f("End of comment missing");var s=t.slice(2,r-2);return n+=2,i(s),t=t.slice(r),n+=2,e({type:"comment",comment:s})}}function g(){var t=h(/^([^{]+)/);if(t)return o(t[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(t){return t.replace(/,/g,"â€Œ")}).split(/\s*(?![^(]*\)),\s*/).map(function(t){return t.replace(/\u200C/g,",")})}function w(){var t=a(),e=h(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(e){if(e=o(e[0]),!h(/^:\s*/))return f("property missing ':'");var r=h(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),n=t({type:"declaration",property:e.replace(s,""),value:r?o(r[0]).replace(s,""):""});return h(/^[;\s]*/),n}}function k(){var t,e=[];if(!p())return f("missing '{'");for(y(e);t=w();)!1!==t&&(e.push(t),y(e));return l()?e:f("missing '}'")}function A(){for(var t,e=[],r=a();t=h(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)e.push(t[1]),h(/^,\s*/);if(e.length)return r({type:"keyframe",values:e,declarations:k()})}var V=j("import"),E=j("charset"),b=j("namespace");function j(t){var e=new RegExp("^@"+t+"\\s*([^;]+);");return function(){var r=a(),n=h(e);if(n){var i={type:t};return i[t]=n[1].trim(),r(i)}}}function W(){if("@"==t[0])return function(){var t=a();if(e=h(/^@([-\w]+)?keyframes\s*/)){var e,r=e[1];if(!(e=h(/^([-\w]+)\s*/)))return f("@keyframes missing name");var n,i=e[1];if(!p())return f("@keyframes missing '{'");for(var s=y();n=A();)s.push(n),s=s.concat(y());return l()?t({type:"keyframes",name:i,vendor:r,keyframes:s}):f("@keyframes missing '}'")}}()||function(){var t=a(),e=h(/^@media *([^{]+)/);if(e){var r=o(e[1]);if(!p())return f("@media missing '{'");var n=y().concat(m());return l()?t({type:"media",media:r,rules:n}):f("@media missing '}'")}}()||function(){var t=a(),e=h(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(e)return t({type:"custom-media",name:o(e[1]),media:o(e[2])})}()||function(){var t=a(),e=h(/^@supports *([^{]+)/);if(e){var r=o(e[1]);if(!p())return f("@supports missing '{'");var n=y().concat(m());return l()?t({type:"supports",supports:r,rules:n}):f("@supports missing '}'")}}()||V()||E()||b()||function(){var t=a(),e=h(/^@([-\w]+)?document *([^{]+)/);if(e){var r=o(e[1]),n=o(e[2]);if(!p())return f("@document missing '{'");var i=y().concat(m());return l()?t({type:"document",document:n,vendor:r,rules:i}):f("@document missing '}'")}}()||function(){var t=a();if(h(/^@page */)){var e=g()||[];if(!p())return f("@page missing '{'");for(var r,n=y();r=w();)n.push(r),n=n.concat(y());return l()?t({type:"page",selectors:e,declarations:n}):f("@page missing '}'")}}()||function(){var t=a();if(h(/^@host\s*/)){if(!p())return f("@host missing '{'");var e=y().concat(m());return l()?t({type:"host",rules:e}):f("@host missing '}'")}}()||function(){var t=a();if(h(/^@font-face\s*/)){if(!p())return f("@font-face missing '{'");for(var e,r=y();e=w();)r.push(e),r=r.concat(y());return l()?t({type:"font-face",declarations:r}):f("@font-face missing '}'")}}()}return function t(e,r){var n=e&&"string"==typeof e.type,i=n?e:r;for(var s in e){var o=e[s];Array.isArray(o)?o.forEach(function(e){t(e,i)}):o&&"object"==typeof o&&t(o,i)}return n&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:r||null}),e}({type:"stylesheet",stylesheet:{rules:m(),parsingErrors:c}})}(l);return u(v.stylesheet.rules,h),c(v.stylesheet.rules),f=v,new a(void 0).compile(f)}
//# sourceMappingURL=purifycss.es.js.map
