import t from"glob";var e=/\/\*[^*]*\*+([^\/*][^*]*\*+)*\//g;function n(t){return t?t.replace(/^\s+|\s+$/g,""):""}function i(t){this.options=t||{},this.indentation=t.indent}i.prototype.emit=function(t){return t},i.prototype.visit=function(t){return this[t.type](t)},i.prototype.mapVisit=function(t,e){var n="";e=e||"";for(var i=0,r=t.length;i<r;i++)n+=this.visit(t[i]),e&&i<r-1&&(n+=this.emit(e));return n},i.prototype.compile=function(t){return this.stylesheet(t)},i.prototype.stylesheet=function(t){return this.mapVisit(t.stylesheet.rules,"\n\n")},i.prototype.comment=function(t){return this.emit(this.indent()+"/*"+t.comment+"*/",t.position)},i.prototype.import=function(t){return this.emit("@import "+t.import+";",t.position)},i.prototype.media=function(t){return this.emit("@media "+t.media,t.position)+this.emit(" {\n"+this.indent(1))+this.mapVisit(t.rules,"\n\n")+this.emit(this.indent(-1)+"\n}")},i.prototype.document=function(t){return this.emit("@"+(t.vendor||"")+"document "+t.document,t.position)+this.emit("  {\n"+this.indent(1))+this.mapVisit(t.rules,"\n\n")+this.emit(this.indent(-1)+"\n}")},i.prototype.charset=function(t){return this.emit("@charset "+t.charset+";",t.position)},i.prototype.namespace=function(t){return this.emit("@namespace "+t.namespace+";",t.position)},i.prototype.supports=function(t){return this.emit("@supports "+t.supports,t.position)+this.emit(" {\n"+this.indent(1))+this.mapVisit(t.rules,"\n\n")+this.emit(this.indent(-1)+"\n}")},i.prototype.keyframes=function(t){return this.emit("@"+(t.vendor||"")+"keyframes "+t.name,t.position)+this.emit(" {\n"+this.indent(1))+this.mapVisit(t.keyframes,"\n")+this.emit(this.indent(-1)+"}")},i.prototype.keyframe=function(t){var e=t.declarations;return this.emit(this.indent())+this.emit(t.values.join(", "),t.position)+this.emit(" {\n"+this.indent(1))+this.mapVisit(e,"\n")+this.emit(this.indent(-1)+"\n"+this.indent()+"}\n")},i.prototype.page=function(t){var e=t.selectors.length?t.selectors.join(", ")+" ":"";return this.emit("@page "+e,t.position)+this.emit("{\n")+this.emit(this.indent(1))+this.mapVisit(t.declarations,"\n")+this.emit(this.indent(-1))+this.emit("\n}")},i.prototype["font-face"]=function(t){return this.emit("@font-face ",t.position)+this.emit("{\n")+this.emit(this.indent(1))+this.mapVisit(t.declarations,"\n")+this.emit(this.indent(-1))+this.emit("\n}")},i.prototype.host=function(t){return this.emit("@host",t.position)+this.emit(" {\n"+this.indent(1))+this.mapVisit(t.rules,"\n\n")+this.emit(this.indent(-1)+"\n}")},i.prototype["custom-media"]=function(t){return this.emit("@custom-media "+t.name+" "+t.media+";",t.position)},i.prototype.rule=function(t){var e=this.indent(),n=t.declarations;return n.length?this.emit(t.selectors.map(function(t){return e+t}).join(",\n"),t.position)+this.emit(" {\n")+this.emit(this.indent(1))+this.mapVisit(n,"\n")+this.emit(this.indent(-1))+this.emit("\n"+this.indent()+"}"):""},i.prototype.declaration=function(t){return this.emit(this.indent())+this.emit(t.property+": "+t.value,t.position)+this.emit(";")},i.prototype.indent=function(t){return this.level=this.level||1,null!=t?(this.level+=t,""):Array(this.level).join(this.indentation||"  ")};var r=function(t,e){this.startingSource=t,this.ast=null,this.plugins=e};r.prototype.beginReading=function(){this.ast=function(t,i){i=i||{};var r=1,s=1;function o(t){var e=t.match(/\n/g);e&&(r+=e.length);var n=t.lastIndexOf("\n");s=~n?t.length-n:s+t.length}function u(){var t={line:r,column:s};return function(e){return e.position=new a(t),d(),e}}function a(t){this.start=t,this.end={line:r,column:s},this.source=i.source}a.prototype.content=t;var c=[];function p(e){var n=new Error(i.source+":"+r+":"+s+": "+e);if(n.reason=e,n.filename=i.source,n.line=r,n.column=s,n.source=t,!i.silent)throw n;c.push(n)}function h(){return m(/^{\s*/)}function f(){return m(/^}/)}function l(){var e,n,i,r=[];for(d(),v(r);t.length&&"}"!=t.charAt(0)&&(e=R()||(n=void 0,n=u(),(i=g())?(v(),n({type:"rule",selectors:i,declarations:S()})):p("selector missing")));)!1!==e&&(r.push(e),v(r));return r}function m(e){var n=e.exec(t);if(n){var i=n[0];return o(i),t=t.slice(i.length),n}}function d(){m(/^\s*/)}function v(t){var e;for(t=t||[];e=y();)!1!==e&&t.push(e);return t}function y(){var e=u();if("/"==t.charAt(0)&&"*"==t.charAt(1)){for(var n=2;""!=t.charAt(n)&&("*"!=t.charAt(n)||"/"!=t.charAt(n+1));)++n;if(""===t.charAt((n+=2)-1))return p("End of comment missing");var i=t.slice(2,n-2);return s+=2,o(i),t=t.slice(n),s+=2,e({type:"comment",comment:i})}}function g(){var t=m(/^([^{]+)/);if(t)return n(t[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(t){return t.replace(/,/g,"â€Œ")}).split(/\s*(?![^(]*\)),\s*/).map(function(t){return t.replace(/\u200C/g,",")})}function w(){var t=u(),i=m(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(i){if(i=n(i[0]),!m(/^:\s*/))return p("property missing ':'");var r=m(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),s=t({type:"declaration",property:i.replace(e,""),value:r?n(r[0]).replace(e,""):""});return m(/^[;\s]*/),s}}function S(){var t,e=[];if(!h())return p("missing '{'");for(v(e);t=w();)!1!==t&&(e.push(t),v(e));return f()?e:p("missing '}'")}function j(){for(var t,e=[],n=u();t=m(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)e.push(t[1]),m(/^,\s*/);if(e.length)return n({type:"keyframe",values:e,declarations:S()})}var E=A("import"),b=A("charset"),k=A("namespace");function A(t){var e=new RegExp("^@"+t+"\\s*([^;]+);");return function(){var n=u(),i=m(e);if(i){var r={type:t};return r[t]=i[1].trim(),n(r)}}}function R(){if("@"==t[0])return function(){var t=u();if(e=m(/^@([-\w]+)?keyframes\s*/)){var e,n=e[1];if(!(e=m(/^([-\w]+)\s*/)))return p("@keyframes missing name");var i,r=e[1];if(!h())return p("@keyframes missing '{'");for(var s=v();i=j();)s.push(i),s=s.concat(v());return f()?t({type:"keyframes",name:r,vendor:n,keyframes:s}):p("@keyframes missing '}'")}}()||function(){var t=u(),e=m(/^@media *([^{]+)/);if(e){var i=n(e[1]);if(!h())return p("@media missing '{'");var r=v().concat(l());return f()?t({type:"media",media:i,rules:r}):p("@media missing '}'")}}()||function(){var t=u(),e=m(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(e)return t({type:"custom-media",name:n(e[1]),media:n(e[2])})}()||function(){var t=u(),e=m(/^@supports *([^{]+)/);if(e){var i=n(e[1]);if(!h())return p("@supports missing '{'");var r=v().concat(l());return f()?t({type:"supports",supports:i,rules:r}):p("@supports missing '}'")}}()||E()||b()||k()||function(){var t=u(),e=m(/^@([-\w]+)?document *([^{]+)/);if(e){var i=n(e[1]),r=n(e[2]);if(!h())return p("@document missing '{'");var s=v().concat(l());return f()?t({type:"document",document:r,vendor:i,rules:s}):p("@document missing '}'")}}()||function(){var t=u();if(m(/^@page */)){var e=g()||[];if(!h())return p("@page missing '{'");for(var n,i=v();n=w();)i.push(n),i=i.concat(v());return f()?t({type:"page",selectors:e,declarations:i}):p("@page missing '}'")}}()||function(){var t=u();if(m(/^@host\s*/)){if(!h())return p("@host missing '{'");var e=v().concat(l());return f()?t({type:"host",rules:e}):p("@host missing '}'")}}()||function(){var t=u();if(m(/^@font-face\s*/)){if(!h())return p("@font-face missing '{'");for(var e,n=v();e=w();)n.push(e),n=n.concat(v());return f()?t({type:"font-face",declarations:n}):p("@font-face missing '}'")}}()}return function t(e,n){var i=e&&"string"==typeof e.type,r=i?e:n;for(var s in e){var o=e[s];Array.isArray(o)?o.forEach(function(e){t(e,r)}):o&&"object"==typeof o&&t(o,r)}return i&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:n||null}),e}({type:"stylesheet",stylesheet:{rules:l(),parsingErrors:c}})}(this.startingSource),this.readPlugin(this.ast.stylesheet)},r.prototype.readPlugin=function(t){this.readRules(t.rules),this.removeEmptyRules(t.rules)},r.prototype.readRules=function(t){for(var e=this,n=function(){var t=r[i];"rule"===t.type&&e.plugins.forEach(function(e){e.parseRule(t.selectors,t)}),"media"===t.type&&e.readRules(t.rules)},i=0,r=t;i<r.length;i+=1)n()},r.prototype.removeEmptyRules=function(t){for(var e=[],n=0,i=t;n<i.length;n+=1){var r=i[n],s=r.type;"rule"===s&&0===r.selectors.length&&e.push(r),"media"===s&&(this.removeEmptyRules(r.rules),0===r.rules.length&&e.push(r))}e.forEach(function(e){var n=t.indexOf(e);t.splice(n,1)})},r.prototype.toString=function(){return this.ast?(t=this.ast,e={},new i(e).compile(t)).replace(/,\n/g,","):"";var t,e};var s=require("fs"),o=function(e,n){var i="content"===n;return Array.isArray(e)?function(t,e){return t.reduce(function(t,e){var n="";try{n=s.readFileSync(e,"utf8").toLowerCase()}catch(t){console.warn(t.message)}return""+t+n+" "},"")}(e=function(n){for(var i={},r=0,o=e;r<o.length;r+=1){var u=o[r];try{s.statSync(u),i[u]=!0}catch(e){t.sync(u).forEach(function(t){i[t]=!0})}}return Object.keys(i)}()):i?e.toLowerCase():e},u=function(t,e){e&&t.push(e)},a=function(t){if((t=t.replace(/\[(.+?)\]/g,"").toLowerCase()).includes("[")||t.includes("]"))return[];for(var e=!1,n="",i=[],r=0,s=t;r<s.length;r+=1){var o=s[r];e&&!/[ #.]/.test(o)||(/[:*]/.test(o)?(u(i,n),n="",e=!0):/[a-z]/.test(o)?n+=o:(u(i,n),n="",e=!1))}return u(i,n),i},c=function(t,e){this.contentWords=t,this.rejectedSelectors=[],this.wildcardWhitelist=[],this.parseWhitelist(e)};c.prototype.parseWhitelist=function(t){var e=this;t.forEach(function(t){var n;"*"===(n=t=t.toLowerCase())[0]&&"*"===n[n.length-1]?e.wildcardWhitelist.push(t.substr(1,t.length-2)):a(t).forEach(function(t){e.contentWords[t]=!0})})},c.prototype.parseRule=function(t,e){e.selectors=this.filterSelectors(t)},c.prototype.filterSelectors=function(t){var e=this.contentWords,n=this.rejectedSelectors,i=this.wildcardWhitelist,r=[];return t.forEach(function(t){if(function(t,e){for(var n=0,r=i;n<r.length;n+=1)if(t.includes(r[n]))return!0;return!1}(t))r.push(t);else{var s=a(t);s.filter(function(t){return e[t]}).length===s.length?r.push(t):n.push(t)}}),r};var p=require("fs"),h={output:!1,info:!1,rejected:!1,whitelist:[]};export default function(t,e,n,i){"function"==typeof n&&(i=n,n={}),n=function(t){void 0===t&&(t={});var e={};for(var n in h)e[n]=t[n]||h[n];return e}(n);var s=o(e,"css"),u=function(e){for(var n={html:!0,body:!0},i=0,r=o(t,"content").split(/[^a-z]/g);i<r.length;i+=1)n[r[i]]=!0;return n}(),a=new c(u,n.whitelist),f=new r(s,[a]);f.beginReading();var l,m=f.toString();if(n.info&&(l=((void 0-m.length)/void 0*100).toFixed(1),console.log("PurifyCSS has reduced the file size by ~ "+l+"%")),n.rejected&&a.rejectedSelectors.length&&console.log("PurifyCSS - Rejected selectors:\n    "+a.rejectedSelectors.join("\n    |\t")),!n.output)return i?i(m):m;p.writeFile(n.output,m,function(t){if(t)return t})}
//# sourceMappingURL=purifycss.es.js.map
