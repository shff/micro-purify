{"version":3,"file":"purifycss.js","sources":["../src/utils/parse.js","../src/utils/compile.js","../src/utils/FileUtil.js","../src/purifycss.js"],"sourcesContent":["/*\n\nCode extracted from https://github.com/reworkcss/css\n\n\n\n(The MIT License)\n\nCopyright (c) 2012 TJ Holowaychuk <tj@vision-media.ca>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the 'Software'), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n*/\n\n// http://www.w3.org/TR/CSS21/grammar.html\n// https://github.com/visionmedia/css-parse/pull/49#issuecomment-30088027\nvar commentre = /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//g;\n\nexport default function(css, options) {\n  options = options || {};\n\n  /**\n   * Positional.\n   */\n\n  var lineno = 1;\n  var column = 1;\n\n  /**\n   * Update lineno and column based on `str`.\n   */\n\n  function updatePosition(str) {\n    var lines = str.match(/\\n/g);\n    if (lines) lineno += lines.length;\n    var i = str.lastIndexOf(\"\\n\");\n    column = ~i ? str.length - i : column + str.length;\n  }\n\n  /**\n   * Mark position and patch `node.position`.\n   */\n\n  function position() {\n    var start = { line: lineno, column: column };\n    return function(node) {\n      node.position = new Position(start);\n      whitespace();\n      return node;\n    };\n  }\n\n  /**\n   * Store position information for a node\n   */\n\n  function Position(start) {\n    this.start = start;\n    this.end = { line: lineno, column: column };\n    this.source = options.source;\n  }\n\n  /**\n   * Non-enumerable source string\n   */\n\n  Position.prototype.content = css;\n\n  /**\n   * Error `msg`.\n   */\n\n  var errorsList = [];\n\n  function error(msg) {\n    var err = new Error(\n      options.source + \":\" + lineno + \":\" + column + \": \" + msg\n    );\n    err.reason = msg;\n    err.filename = options.source;\n    err.line = lineno;\n    err.column = column;\n    err.source = css;\n\n    if (options.silent) {\n      errorsList.push(err);\n    } else {\n      throw err;\n    }\n  }\n\n  /**\n   * Parse stylesheet.\n   */\n\n  function stylesheet() {\n    var rulesList = rules();\n\n    return {\n      type: \"stylesheet\",\n      stylesheet: {\n        rules: rulesList,\n        parsingErrors: errorsList\n      }\n    };\n  }\n\n  /**\n   * Opening brace.\n   */\n\n  function open() {\n    return match(/^{\\s*/);\n  }\n\n  /**\n   * Closing brace.\n   */\n\n  function close() {\n    return match(/^}/);\n  }\n\n  /**\n   * Parse ruleset.\n   */\n\n  function rules() {\n    var node;\n    var rules = [];\n    whitespace();\n    comments(rules);\n    while (css.length && css.charAt(0) != \"}\" && (node = atrule() || rule())) {\n      if (node !== false) {\n        rules.push(node);\n        comments(rules);\n      }\n    }\n    return rules;\n  }\n\n  /**\n   * Match `re` and return captures.\n   */\n\n  function match(re) {\n    var m = re.exec(css);\n    if (!m) return;\n    var str = m[0];\n    updatePosition(str);\n    css = css.slice(str.length);\n    return m;\n  }\n\n  /**\n   * Parse whitespace.\n   */\n\n  function whitespace() {\n    match(/^\\s*/);\n  }\n\n  /**\n   * Parse comments;\n   */\n\n  function comments(rules) {\n    var c;\n    rules = rules || [];\n    while ((c = comment())) {\n      if (c !== false) {\n        rules.push(c);\n      }\n    }\n    return rules;\n  }\n\n  /**\n   * Parse comment.\n   */\n\n  function comment() {\n    var pos = position();\n    if (\"/\" != css.charAt(0) || \"*\" != css.charAt(1)) return;\n\n    var i = 2;\n    while (\n      \"\" != css.charAt(i) &&\n      (\"*\" != css.charAt(i) || \"/\" != css.charAt(i + 1))\n    )\n      ++i;\n    i += 2;\n\n    if (\"\" === css.charAt(i - 1)) {\n      return error(\"End of comment missing\");\n    }\n\n    var str = css.slice(2, i - 2);\n    column += 2;\n    updatePosition(str);\n    css = css.slice(i);\n    column += 2;\n\n    return pos({\n      type: \"comment\",\n      comment: str\n    });\n  }\n\n  /**\n   * Parse selector.\n   */\n\n  function selector() {\n    var m = match(/^([^{]+)/);\n    if (!m) return;\n    /* @fix Remove all comments from selectors\n     * http://ostermiller.org/findcomment.html */\n    return trim(m[0])\n      .replace(/\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*\\/+/g, \"\")\n      .replace(/\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'/g, function(m) {\n        return m.replace(/,/g, \"\\u200C\");\n      })\n      .split(/\\s*(?![^(]*\\)),\\s*/)\n      .map(function(s) {\n        return s.replace(/\\u200C/g, \",\");\n      });\n  }\n\n  /**\n   * Parse declaration.\n   */\n\n  function declaration() {\n    var pos = position();\n\n    // prop\n    var prop = match(/^(\\*?[-#\\/\\*\\\\\\w]+(\\[[0-9a-z_-]+\\])?)\\s*/);\n    if (!prop) return;\n    prop = trim(prop[0]);\n\n    // :\n    if (!match(/^:\\s*/)) return error(\"property missing ':'\");\n\n    // val\n    var val = match(/^((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^\\)]*?\\)|[^};])+)/);\n\n    var ret = pos({\n      type: \"declaration\",\n      property: prop.replace(commentre, \"\"),\n      value: val ? trim(val[0]).replace(commentre, \"\") : \"\"\n    });\n\n    // ;\n    match(/^[;\\s]*/);\n\n    return ret;\n  }\n\n  /**\n   * Parse declarations.\n   */\n\n  function declarations() {\n    var decls = [];\n\n    if (!open()) return error(\"missing '{'\");\n    comments(decls);\n\n    // declarations\n    var decl;\n    while ((decl = declaration())) {\n      if (decl !== false) {\n        decls.push(decl);\n        comments(decls);\n      }\n    }\n\n    if (!close()) return error(\"missing '}'\");\n    return decls;\n  }\n\n  /**\n   * Parse keyframe.\n   */\n\n  function keyframe() {\n    var m;\n    var vals = [];\n    var pos = position();\n\n    while ((m = match(/^((\\d+\\.\\d+|\\.\\d+|\\d+)%?|[a-z]+)\\s*/))) {\n      vals.push(m[1]);\n      match(/^,\\s*/);\n    }\n\n    if (!vals.length) return;\n\n    return pos({\n      type: \"keyframe\",\n      values: vals,\n      declarations: declarations()\n    });\n  }\n\n  /**\n   * Parse keyframes.\n   */\n\n  function atkeyframes() {\n    var pos = position();\n    var m = match(/^@([-\\w]+)?keyframes\\s*/);\n\n    if (!m) return;\n    var vendor = m[1];\n\n    // identifier\n    var m = match(/^([-\\w]+)\\s*/);\n    if (!m) return error(\"@keyframes missing name\");\n    var name = m[1];\n\n    if (!open()) return error(\"@keyframes missing '{'\");\n\n    var frame;\n    var frames = comments();\n    while ((frame = keyframe())) {\n      frames.push(frame);\n      frames = frames.concat(comments());\n    }\n\n    if (!close()) return error(\"@keyframes missing '}'\");\n\n    return pos({\n      type: \"keyframes\",\n      name: name,\n      vendor: vendor,\n      keyframes: frames\n    });\n  }\n\n  /**\n   * Parse supports.\n   */\n\n  function atsupports() {\n    var pos = position();\n    var m = match(/^@supports *([^{]+)/);\n\n    if (!m) return;\n    var supports = trim(m[1]);\n\n    if (!open()) return error(\"@supports missing '{'\");\n\n    var style = comments().concat(rules());\n\n    if (!close()) return error(\"@supports missing '}'\");\n\n    return pos({\n      type: \"supports\",\n      supports: supports,\n      rules: style\n    });\n  }\n\n  /**\n   * Parse host.\n   */\n\n  function athost() {\n    var pos = position();\n    var m = match(/^@host\\s*/);\n\n    if (!m) return;\n\n    if (!open()) return error(\"@host missing '{'\");\n\n    var style = comments().concat(rules());\n\n    if (!close()) return error(\"@host missing '}'\");\n\n    return pos({\n      type: \"host\",\n      rules: style\n    });\n  }\n\n  /**\n   * Parse media.\n   */\n\n  function atmedia() {\n    var pos = position();\n    var m = match(/^@media *([^{]+)/);\n\n    if (!m) return;\n    var media = trim(m[1]);\n\n    if (!open()) return error(\"@media missing '{'\");\n\n    var style = comments().concat(rules());\n\n    if (!close()) return error(\"@media missing '}'\");\n\n    return pos({\n      type: \"media\",\n      media: media,\n      rules: style\n    });\n  }\n\n  /**\n   * Parse custom-media.\n   */\n\n  function atcustommedia() {\n    var pos = position();\n    var m = match(/^@custom-media\\s+(--[^\\s]+)\\s*([^{;]+);/);\n    if (!m) return;\n\n    return pos({\n      type: \"custom-media\",\n      name: trim(m[1]),\n      media: trim(m[2])\n    });\n  }\n\n  /**\n   * Parse paged media.\n   */\n\n  function atpage() {\n    var pos = position();\n    var m = match(/^@page */);\n    if (!m) return;\n\n    var sel = selector() || [];\n\n    if (!open()) return error(\"@page missing '{'\");\n    var decls = comments();\n\n    // declarations\n    var decl;\n    while ((decl = declaration())) {\n      decls.push(decl);\n      decls = decls.concat(comments());\n    }\n\n    if (!close()) return error(\"@page missing '}'\");\n\n    return pos({\n      type: \"page\",\n      selectors: sel,\n      declarations: decls\n    });\n  }\n\n  /**\n   * Parse document.\n   */\n\n  function atdocument() {\n    var pos = position();\n    var m = match(/^@([-\\w]+)?document *([^{]+)/);\n    if (!m) return;\n\n    var vendor = trim(m[1]);\n    var doc = trim(m[2]);\n\n    if (!open()) return error(\"@document missing '{'\");\n\n    var style = comments().concat(rules());\n\n    if (!close()) return error(\"@document missing '}'\");\n\n    return pos({\n      type: \"document\",\n      document: doc,\n      vendor: vendor,\n      rules: style\n    });\n  }\n\n  /**\n   * Parse font-face.\n   */\n\n  function atfontface() {\n    var pos = position();\n    var m = match(/^@font-face\\s*/);\n    if (!m) return;\n\n    if (!open()) return error(\"@font-face missing '{'\");\n    var decls = comments();\n\n    // declarations\n    var decl;\n    while ((decl = declaration())) {\n      decls.push(decl);\n      decls = decls.concat(comments());\n    }\n\n    if (!close()) return error(\"@font-face missing '}'\");\n\n    return pos({\n      type: \"font-face\",\n      declarations: decls\n    });\n  }\n\n  /**\n   * Parse import\n   */\n\n  var atimport = _compileAtrule(\"import\");\n\n  /**\n   * Parse charset\n   */\n\n  var atcharset = _compileAtrule(\"charset\");\n\n  /**\n   * Parse namespace\n   */\n\n  var atnamespace = _compileAtrule(\"namespace\");\n\n  /**\n   * Parse non-block at-rules\n   */\n\n  function _compileAtrule(name) {\n    var re = new RegExp(\"^@\" + name + \"\\\\s*([^;]+);\");\n    return function() {\n      var pos = position();\n      var m = match(re);\n      if (!m) return;\n      var ret = { type: name };\n      ret[name] = m[1].trim();\n      return pos(ret);\n    };\n  }\n\n  /**\n   * Parse at rule.\n   */\n\n  function atrule() {\n    if (css[0] != \"@\") return;\n\n    return (\n      atkeyframes() ||\n      atmedia() ||\n      atcustommedia() ||\n      atsupports() ||\n      atimport() ||\n      atcharset() ||\n      atnamespace() ||\n      atdocument() ||\n      atpage() ||\n      athost() ||\n      atfontface()\n    );\n  }\n\n  /**\n   * Parse rule.\n   */\n\n  function rule() {\n    var pos = position();\n    var sel = selector();\n\n    if (!sel) return error(\"selector missing\");\n    comments();\n\n    return pos({\n      type: \"rule\",\n      selectors: sel,\n      declarations: declarations()\n    });\n  }\n\n  return addParent(stylesheet());\n}\n\n/**\n * Trim `str`.\n */\n\nfunction trim(str) {\n  return str ? str.replace(/^\\s+|\\s+$/g, \"\") : \"\";\n}\n\n/**\n * Adds non-enumerable parent node reference to each node.\n */\n\nfunction addParent(obj, parent) {\n  var isNode = obj && typeof obj.type === \"string\";\n  var childParent = isNode ? obj : parent;\n\n  for (var k in obj) {\n    var value = obj[k];\n    if (Array.isArray(value)) {\n      value.forEach(function(v) {\n        addParent(v, childParent);\n      });\n    } else if (value && typeof value === \"object\") {\n      addParent(value, childParent);\n    }\n  }\n\n  if (isNode) {\n    Object.defineProperty(obj, \"parent\", {\n      configurable: true,\n      writable: true,\n      enumerable: false,\n      value: parent || null\n    });\n  }\n\n  return obj;\n}\n","/*\n\nCode extracted from https://github.com/reworkcss/css\n\n\n\n(The MIT License)\n\nCopyright (c) 2012 TJ Holowaychuk <tj@vision-media.ca>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the 'Software'), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n*/\n\nexport default (node, options) => new Compiler(options).compile(node);\n\nfunction Compiler(options = {}) {\n  this.options = options;\n}\n\nCompiler.prototype.compile = function(node) {\n  return this.stylesheet(node);\n};\n\nCompiler.prototype.stylesheet = function(node) {\n  return this.mapVisit(node.stylesheet.rules);\n};\n\nCompiler.prototype.mapVisit = function(nodes) {\n  return nodes.map(node => this[node.type](node)).join(\"\");\n};\n\nCompiler.prototype.comment = function() {\n  return \"\";\n};\n\nCompiler.prototype.import = function(node) {\n  return \"@import \" + node.import + \";\";\n};\n\nCompiler.prototype.media = function({ media, rules }) {\n  return \"@media \" + media + \"{\" + this.mapVisit(rules) + \"}\";\n};\n\nCompiler.prototype.document = function({ vendor, document, rules }) {\n  var doc = \"@\" + (vendor || \"\") + \"document \" + document;\n\n  return doc + (\" \" + \" {\") + this.mapVisit(rules) + \"}\";\n};\n\nCompiler.prototype.charset = function({ charset }) {\n  return \"@charset \" + charset + \";\";\n};\n\nCompiler.prototype.namespace = function({ namespace }) {\n  return \"@namespace \" + namespace + \";\";\n};\n\nCompiler.prototype.supports = function({ supports, rules }) {\n  return \"@supports \" + supports + \" {\" + this.mapVisit(rules) + \"}\";\n};\n\nCompiler.prototype.keyframes = function({ vendor, name, keyframes }) {\n  return (\n    \"@\" +\n    (vendor || \"\") +\n    \"keyframes \" +\n    name +\n    \" {\" +\n    this.mapVisit(keyframes) +\n    \"}\"\n  );\n};\n\nCompiler.prototype.keyframe = function({ declarations, values }) {\n  return values.join(\", \") + \" {\" + this.mapVisit(declarations) + \"}\";\n};\n\nCompiler.prototype.page = function({ selectors, declarations }) {\n  var sel = selectors.length ? selectors.join(\", \") + \" \" : \"\";\n\n  return \"@page \" + sel + \"{\" + this.mapVisit(declarations) + \"}\";\n};\n\nCompiler.prototype[\"font-face\"] = function({ declarations }) {\n  return \"@font-face \" + \"{\" + this.mapVisit(declarations) + \"}\";\n};\n\nCompiler.prototype.host = function({ rules }) {\n  return \"@host\" + \" {\" + this.mapVisit(rules) + \"}\";\n};\n\nCompiler.prototype[\"custom-media\"] = function({ name, media }) {\n  return \"@custom-media \" + name + \" \" + media + \";\";\n};\n\nCompiler.prototype.rule = function({ declarations, selectors }) {\n  if (!declarations.length) return \"\";\n\n  return selectors.join(\",\") + \"{\" + this.mapVisit(declarations) + \"}\";\n};\n\nCompiler.prototype.declaration = function({ property, value }) {\n  return property + \": \" + value + \";\";\n};\n","const fs = require(\"fs\");\nimport glob from \"glob\";\n\nexport const concatFiles = (files, options) =>\n  files.reduce((total, file) => {\n    let code = \"\";\n    try {\n      code = fs.readFileSync(file, \"utf8\").toLowerCase();\n    } catch (e) {\n      console.warn(e.message);\n    }\n    return `${total}${code} `;\n  }, \"\");\n\nexport const getFilesFromPatternArray = fileArray => {\n  let sourceFiles = {};\n  for (let string of fileArray) {\n    try {\n      // See if string is a filepath, not a file pattern.\n      fs.statSync(string);\n      sourceFiles[string] = true;\n    } catch (e) {\n      const files = glob.sync(string);\n      files.forEach(file => {\n        sourceFiles[file] = true;\n      });\n    }\n  }\n  return Object.keys(sourceFiles);\n};\n\nexport const filesToSource = (files) => {\n  if (Array.isArray(files)) {\n    files = getFilesFromPatternArray(files);\n    return concatFiles(files, {});\n  }\n  // 'files' is already a source string.\n  return files;\n};\n\nexport default {\n  filesToSource\n};\n","const fs = require(\"fs\");\nimport parse from \"./utils/parse\";\nimport compile from \"./utils/compile\";\nimport FileUtil from \"./utils/FileUtil\";\n\nconst RULE_TYPE = \"rule\";\nconst MEDIA_TYPE = \"media\";\n\nconst getAllWordsInContent = content =>\n  content.split(/[^a-z]/g).concat([\"body\", \"html\"]);\n\nvar getAllWordsInSelector = selector => {\n  return selector\n    .replace(/\\[(.*?)\\]/g, \"\")\n    .replace(/[:*][a-z-_:]+/g, \"\")\n    .toLowerCase()\n    .match(/[a-z]+/g) || [];\n}\n\nconst readRules = (rules, filter) => {\n  for (let rule of rules) {\n    if (rule.type === RULE_TYPE) {\n      filter(rule);\n    } else if (rule.type === MEDIA_TYPE) {\n      readRules(rule.rules, filter);\n    }\n  }\n};\n\nconst removeEmptyRules = rules => {\n  let emptyRules = [];\n  for (let rule of rules) {\n    if (rule.type === RULE_TYPE && rule.selectors.length === 0) {\n      emptyRules.push(rule);\n    } else if (rule.type === MEDIA_TYPE) {\n      removeEmptyRules(rule.rules);\n      if (rule.rules.length === 0) {\n        emptyRules.push(rule);\n      }\n    }\n  }\n  emptyRules.forEach(emptyRule => rules.splice(rules.indexOf(emptyRule), 1));\n};\n\nconst filterSelectors = (selectors, contentWords) => {\n  return selectors.filter(selector => {\n    const words = getAllWordsInSelector(selector);\n    const usedWords = words.filter(word => contentWords.includes(word));\n    return usedWords.length === words.length;\n  });\n};\n\nexport default (searchThrough, css, options = {}) => {\n  const whitelist = options.whitelist || [];\n  const cssString = FileUtil.filesToSource(css);\n  const content = FileUtil.filesToSource(searchThrough).toLowerCase();\n  const wordsInContent = getAllWordsInContent(content).concat(whitelist);\n\n  const ast = parse(cssString);\n  const rules = ast.stylesheet.rules;\n  readRules(\n    rules,\n    rule => (rule.selectors = filterSelectors(rule.selectors, wordsInContent))\n  );\n  removeEmptyRules(rules);\n\n  return compile(ast);\n};\n"],"names":["commentre","trim","str","replace","Compiler","options","prototype","compile","node","this","stylesheet","mapVisit","rules","nodes","map","type","join","comment","import","media","ref","document","charset","namespace","supports","keyframes","keyframe","declarations","page","selectors","length","host","rule","declaration","const","fs","require","files","Array","isArray","reduce","total","file","code","readFileSync","toLowerCase","e","console","warn","message","concatFiles","fileArray","sourceFiles","let","string","statSync","glob","sync","forEach","Object","keys","getFilesFromPatternArray","readRules","filter","removeEmptyRules","emptyRules","push","emptyRule","splice","indexOf","searchThrough","css","whitelist","cssString","FileUtil","wordsInContent","split","concat","ast","lineno","column","updatePosition","lines","match","i","lastIndexOf","position","start","line","Position","whitespace","end","source","content","errorsList","error","msg","err","Error","reason","filename","silent","open","close","pos","sel","comments","charAt","atrule","selector","re","m","exec","slice","c","s","prop","val","ret","property","value","decl","decls","vals","values","atimport","_compileAtrule","atcharset","atnamespace","name","RegExp","vendor","frame","frames","atkeyframes","style","atmedia","atcustommedia","atsupports","doc","atdocument","atpage","athost","atfontface","addParent","obj","parent","isNode","childParent","k","v","defineProperty","configurable","writable","enumerable","parsingErrors","parse","contentWords","words","getAllWordsInSelector","word","includes"],"mappings":"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"}